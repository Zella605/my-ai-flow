<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Vision Sync 6.0 | åŸæ¯”ä¾‹å¤šå›¾ç‰ˆ</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* å®ç°ç€‘å¸ƒæµå¸ƒå±€ */
        .waterfall-grid {
            column-count: 1;
            column-gap: 1.5rem;
        }
        @media (min-width: 768px) { .waterfall-grid { column-count: 2; } }
        .waterfall-item {
            break-inside: avoid;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const App = () => {
            const [view, setView] = useState('brainstorm');
            const [scrapedData, setScrapedData] = useState([]);
            const [manualData, setManualData] = useState(() => {
                const saved = localStorage.getItem('zella-v6-manual');
                return saved ? JSON.parse(saved) : [];
            });
            const [votes, setVotes] = useState(() => {
                const saved = localStorage.getItem('zella-v6-votes');
                return saved ? JSON.parse(saved) : {};
            });

            // è¡¨å•çŠ¶æ€ï¼šæ”¯æŒå¤šå›¾åœ°å€ï¼ˆé€—å·åˆ†éš”ï¼‰
            const [form, setForm] = useState({ url: '', imgs: '', note: '', title: '' });
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                fetch('./data.json').then(res => res.json()).then(json => {
                    setScrapedData(json);
                    setLoading(false);
                }).catch(() => setLoading(false));
            }, []);

            useEffect(() => {
                localStorage.setItem('zella-v6-manual', JSON.stringify(manualData));
                localStorage.setItem('zella-v6-votes', JSON.stringify(votes));
            }, [manualData, votes]);

            const handleAddLink = () => {
                if (!form.url) return;
                // å°†è¾“å…¥çš„å›¾ç‰‡åœ°å€å­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„
                const imgArray = form.imgs.split(/[,ï¼Œ\n]/).map(i => i.trim()).filter(i => i);
                
                const newIdea = {
                    id: `manual-${Date.now()}`,
                    title: form.title || "è‡ªå®šä¹‰çµæ„Ÿ",
                    source: "MANUAL",
                    url: form.url,
                    images: imgArray.length > 0 ? imgArray : ["https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800"],
                    note: form.note || "æœªå¡«å†™è¯´æ˜",
                    timestamp: Date.now()
                };
                setManualData([newIdea, ...manualData]);
                setForm({ url: '', imgs: '', note: '', title: '' });
            };

            const allIdeas = useMemo(() => {
                const combined = [...manualData, ...scrapedData.map(d => ({...d, images: [d.imageUrl]}))];
                return combined.sort((a, b) => (votes[b.id] || 0) - (votes[a.id] || 0));
            }, [scrapedData, manualData, votes]);

            return (
                <div className="min-h-screen pb-20">
                    <nav className="bg-white/80 backdrop-blur-xl border-b px-6 py-4 flex justify-between items-center sticky top-0 z-50">
                        <div className="flex items-center gap-2">
                            <span className="bg-black text-white px-2 py-0.5 rounded font-black text-[10px]">V6.0</span>
                            <h1 className="font-black tracking-tighter text-slate-800">AI PRO SYNC</h1>
                        </div>
                        <div className="bg-slate-200/50 rounded-2xl p-1 flex">
                            <button onClick={() => setView('brainstorm')} className={`px-5 py-1.5 rounded-xl text-xs font-bold transition-all ${view === 'brainstorm' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-500'}`}>çµæ„Ÿçœ‹æ¿</button>
                            <button onClick={() => setView('roadmap')} className={`px-5 py-1.5 rounded-xl text-xs font-bold transition-all ${view === 'roadmap' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-500'}`}>ç ”å‘è¿›åº¦</button>
                        </div>
                    </nav>

                    <main className="max-w-6xl mx-auto mt-10 px-4">
                        {view === 'brainstorm' ? (
                            <div>
                                {/* é«˜çº§å½•å…¥é¢æ¿ */}
                                <div className="bg-white rounded-[2rem] p-8 mb-12 shadow-sm border border-slate-100">
                                    <h2 className="font-black text-slate-800 mb-6 flex items-center gap-2 italic">ADD NEW INSPIRATION</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div className="space-y-3">
                                            <input value={form.title} onChange={e=>setForm({...form, title:e.target.value})} placeholder="çµæ„Ÿæ ‡é¢˜ (å¦‚ï¼š2025æ–°æ˜¥å…‰å½±ç‰¹æ•ˆ)" className="w-full bg-slate-50 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 ring-indigo-500/20 transition-all"/>
                                            <input value={form.url} onChange={e=>setForm({...form, url:e.target.value})} placeholder="çµæ„Ÿé“¾æ¥ (TikTok/å°çº¢ä¹¦...)" className="w-full bg-slate-50 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 ring-indigo-500/20 transition-all"/>
                                            <textarea value={form.imgs} onChange={e=>setForm({...form, imgs:e.target.value})} placeholder="å›¾ç‰‡åœ°å€ (å¤šå¼ è¯·ç”¨é€—å·æˆ–å›è½¦åˆ†éš”)" className="w-full h-24 bg-slate-50 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 ring-indigo-500/20 transition-all resize-none"/>
                                        </div>
                                        <div className="flex flex-col">
                                            <textarea value={form.note} onChange={e=>setForm({...form, note:e.target.value})} placeholder="çµæ„Ÿè¯´æ˜ï¼šè¿™ä¸ºä»€ä¹ˆå€¼å¾—å‚è€ƒï¼ŸæŠ€æœ¯éš¾ç‚¹åœ¨å“ªï¼Ÿ" className="w-full flex-1 bg-slate-50 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 ring-indigo-500/20 transition-all resize-none mb-3"/>
                                            <button onClick={handleAddLink} className="bg-slate-900 text-white py-4 rounded-xl font-black hover:bg-indigo-600 transition-all shadow-lg shadow-indigo-100">ç¡®è®¤å…¥æ± </button>
                                        </div>
                                    </div>
                                </div>

                                {/* ç€‘å¸ƒæµå±•ç¤ºåŒº */}
                                <div className="waterfall-grid">
                                    {allIdeas.map((item) => (
                                        <Card key={item.id} item={item} votes={votes[item.id]||0} onVote={() => setVotes(v => ({...v, [item.id]: (v[item.id]||0)+1}))} />
                                    ))}
                                </div>
                            </div>
                        ) : <div className="text-center py-20 font-black text-slate-200">ROADMAP LOADING...</div>}
                    </main>
                </div>
            );
        };

        // ç‹¬ç«‹çš„å¡ç‰‡ç»„ä»¶ï¼Œå¤„ç†åŸæ¯”ä¾‹å›¾ç‰‡å’Œå¤šå›¾åˆ‡æ¢
        const Card = ({ item, votes, onVote }) => {
            const [activeImgIndex, setActiveImgIndex] = useState(0);

            return (
                <div className="waterfall-item bg-white rounded-3xl overflow-hidden border border-slate-100 shadow-sm hover:shadow-xl transition-all group border-b-4 border-b-slate-200">
                    {/* å›¾ç‰‡æ˜¾ç¤ºåŒºï¼šåŸæ¯”ä¾‹ */}
                    <div className="relative bg-slate-100">
                        <img 
                            src={item.images[activeImgIndex]} 
                            className="w-full h-auto block group-hover:brightness-95 transition-all"
                            loading="lazy"
                        />
                        {/* å¦‚æœæœ‰å¤šå›¾ï¼Œæ˜¾ç¤ºæŒ‡ç¤ºæ¡ */}
                        {item.images.length > 1 && (
                            <div className="absolute bottom-3 left-0 right-0 flex justify-center gap-1.5 px-4">
                                {item.images.map((_, i) => (
                                    <button 
                                        key={i} 
                                        onClick={(e) => { e.preventDefault(); setActiveImgIndex(i); }}
                                        className={`h-1 rounded-full transition-all ${i === activeImgIndex ? 'w-6 bg-white' : 'w-2 bg-white/40'}`}
                                    />
                                ))}
                            </div>
                        )}
                    </div>

                    <div className="p-5">
                        <div className="flex justify-between items-start mb-3">
                            <h4 className="font-black text-slate-800 leading-tight flex-1 mr-4">{item.title}</h4>
                            <span className="text-[10px] font-black bg-slate-100 px-2 py-0.5 rounded text-slate-400">{item.source}</span>
                        </div>
                        
                        <div className="bg-indigo-50/50 p-4 rounded-2xl mb-4 border border-indigo-100/20">
                            <p className="text-slate-600 text-[11px] font-medium leading-relaxed italic">
                                â€œ {item.note} â€
                            </p>
                        </div>

                        <div className="flex items-center justify-between">
                            <a href={item.url} target="_blank" className="text-[10px] font-black text-indigo-500 uppercase tracking-tighter hover:underline">æŸ¥çœ‹æºç  â†—</a>
                            <button 
                                onClick={onVote}
                                className="bg-slate-900 text-white px-5 py-2 rounded-xl text-xs font-black flex items-center gap-2 active:scale-95 transition-all"
                            >
                                ğŸ”¥ {votes}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
